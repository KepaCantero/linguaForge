npm warn Unknown user config "email". This will stop working in the next major version of npm.
npm warn Unknown user config "always-auth". This will stop working in the next major version of npm.
[{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/InputCard.tsx","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'InputCard' has too many lines (161). Maximum allowed is 120.","line":44,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":204,"endColumn":2},{"ruleId":"react/no-array-index-key","severity":1,"message":"Do not use Array index in keys","line":166,"column":24,"nodeType":"TemplateLiteral","messageId":"noArrayIndex","endLine":166,"endColumn":52}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport Link from 'next/link';\nimport { INPUT_COLORS } from '@/lib/constants';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface InputCardData {\n  id: string;\n  type: 'text' | 'video' | 'audio';\n  title: string;\n  description: string;\n  icon: string;\n  href: string;\n  gradient: string;\n  color: string;\n  stats: Array<{ label: string; value: string | number }>;\n  status?: 'empty' | 'loading' | 'ready';\n  disabled?: boolean;\n}\n\nexport interface InputCardProps {\n  data: InputCardData;\n  index: number;\n  shouldAnimate: boolean;\n}\n\n// ============================================================\n// HELPERS\n// ============================================================\n\n// Get centralized color config for input type\nfunction getCardConfig(type: 'text' | 'video' | 'audio') {\n  return INPUT_COLORS[type];\n}\n\n// ============================================================\n// COMPONENT\n// ============================================================\n\nexport function InputCard({ data, index, shouldAnimate }: InputCardProps) {\n  const config = getCardConfig(data.type);\n\n  const getStatusIndicator = () => {\n    if (data.disabled) {\n      return (\n        <div className=\"absolute top-3 right-3 w-2 h-2 rounded-full bg-slate-500\" />\n      );\n    }\n    switch (data.status) {\n      case 'loading':\n        return (\n          <motion.div\n            className=\"absolute top-3 right-3 w-2 h-2 rounded-full bg-yellow-400\"\n            animate={{ opacity: [0.4, 1, 0.4] }}\n            transition={{ duration: 1.5, repeat: Infinity }}\n          />\n        );\n      case 'ready':\n        return (\n          <div className=\"absolute top-3 right-3 w-2 h-2 rounded-full bg-green-400 shadow-lg shadow-green-400/50\" />\n        );\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 30 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{\n        delay: shouldAnimate ? index * 0.12 : 0,\n        type: 'spring',\n        stiffness: 200,\n        damping: 20,\n      }}\n      className=\"relative group\"\n    >\n      <Link\n        href={data.href}\n        className={`\n          block relative overflow-hidden rounded-2xl\n          bg-gradient-to-br ${config.gradient}\n          border ${config.borderColor} ${config.hoverBorder}\n          backdrop-blur-sm\n          transition-all duration-300 ease-out\n          hover:shadow-xl hover:shadow-black/20\n          ${data.disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n        `}\n        aria-label={`${data.title}: ${data.description}`}\n        tabIndex={data.disabled ? -1 : 0}\n      >\n        {/* Status Indicator */}\n        {getStatusIndicator()}\n\n        {/* Background Glow Effect */}\n        <motion.div\n          className={`absolute inset-0 bg-gradient-to-br ${config.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-300`}\n          whileHover={{ scale: 1.05 }}\n          transition={{ duration: 0.3 }}\n          aria-hidden=\"true\"\n        />\n\n        {/* Content */}\n        <div className=\"relative z-10 p-6\">\n          {/* Icon Section */}\n          <div className=\"flex items-start justify-between mb-4\">\n            <motion.div\n              className={`\n                relative w-16 h-16 rounded-xl\n                bg-gradient-to-br ${config.gradient}\n                border ${config.borderColor}\n                flex items-center justify-center\n                shadow-lg ${config.iconGlow}\n              `}\n              whileHover={{ scale: 1.1, rotate: 5 }}\n              transition={{ type: 'spring', stiffness: 300, damping: 15 }}\n              aria-hidden=\"true\"\n            >\n              {/* Animated glow behind icon */}\n              <motion.div\n                className={`absolute inset-0 rounded-xl blur-xl ${config.textColor} opacity-40`}\n                animate={{\n                  scale: [1, 1.2, 1],\n                  opacity: [0.3, 0.6, 0.3],\n                }}\n                transition={{\n                  duration: 3,\n                  repeat: Infinity,\n                  ease: 'easeInOut',\n                  delay: index * 0.3,\n                }}\n              />\n              <span className=\"text-3xl relative z-10\">{data.icon}</span>\n            </motion.div>\n\n            {/* Arrow indicator */}\n            <motion.span\n              className=\"text-calm-text-muted text-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\"\n              whileHover={{ x: 5 }}\n              aria-hidden=\"true\"\n            >\n              ‚Üí\n            </motion.span>\n          </div>\n\n          {/* Title and Description */}\n          <div className=\"mb-4\">\n            <h3 className={`text-xl font-bold text-white mb-2 group-hover:${config.textColor} transition-colors duration-300`}>\n              {data.title}\n            </h3>\n            <p className=\"text-sm text-calm-text-muted leading-relaxed\">\n              {data.description}\n            </p>\n          </div>\n\n          {/* Stats */}\n          {data.stats.length > 0 && (\n            <div className=\"flex flex-wrap gap-3 pt-3 border-t border-white/10\">\n              {data.stats.map((stat, statIndex) => (\n                <motion.div\n                  key={`${stat.label}-${statIndex}`}\n                  className=\"flex items-center gap-1.5\"\n                  initial={{ opacity: 0, x: -10 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{\n                    delay: shouldAnimate ? index * 0.12 + statIndex * 0.05 : 0,\n                  }}\n                >\n                  <span className={`text-xs font-medium ${config.textColor}`}>\n                    {stat.label}:\n                  </span>\n                  <span className=\"text-xs font-bold text-white\">\n                    {stat.value}\n                  </span>\n                </motion.div>\n              ))}\n            </div>\n          )}\n\n          {/* Disabled overlay */}\n          {data.disabled && (\n            <div className=\"absolute inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center\">\n              <span className=\"text-sm font-medium text-slate-300\">Pr√≥ximamente</span>\n            </div>\n          )}\n        </div>\n\n        {/* Hover highlight effect */}\n        <motion.div\n          className={`absolute bottom-0 left-0 h-1 bg-gradient-to-r ${config.gradient}`}\n          initial={{ width: 0 }}\n          whileHover={{ width: '100%' }}\n          transition={{ duration: 0.3 }}\n          aria-hidden=\"true\"\n        />\n      </Link>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/InputHub.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/LoadedTextView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/TextInputOrbitalHUD.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'radialGlow' is defined but never used.","line":6,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":33},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'TextInputOrbitalHUD' has too many lines (130). Maximum allowed is 120.","line":19,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":148,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion } from 'framer-motion';\nimport { TextStatOrb } from './TextStatsOrb';\nimport type { TextStats } from '@/hooks/useTextStats';\nimport { borderAlpha, radialGlow } from '@/constants/colors';\n\ninterface TextInputOrbitalHUDProps {\n  textStats: TextStats;\n  icon: string;\n  colorStart: string;\n  colorEnd: string;\n}\n\n/**\n * Orbital HUD visualization component for text input stats\n * Reduces parent component complexity by isolating orbital animation logic\n */\nexport function TextInputOrbitalHUD({\n  textStats,\n  icon,\n  colorStart,\n  colorEnd,\n}: TextInputOrbitalHUDProps) {\n  return (\n    <div className=\"relative w-full h-[45vh] flex items-center justify-center\">\n      {/* Outer decorative rings */}\n      {[0, 1, 2, 3].map((i) => (\n        <motion.div\n          key={`text-ring-${i}`}\n          className=\"absolute rounded-full border\"\n          style={{\n            width: `${200 + i * 40}px`,\n            height: `${200 + i * 40}px`,\n            borderColor: borderAlpha('sky', 0.15 - i * 0.03),\n            borderStyle: i % 2 === 0 ? 'solid' : 'dashed',\n          }}\n          animate={{\n            rotate: i % 2 === 0 ? [0, 360] : [360, 0],\n            scale: [1, 1.02, 1],\n          }}\n          transition={{\n            duration: 25 + i * 8,\n            repeat: Infinity,\n            ease: 'linear',\n          }}\n        />\n      ))}\n\n      {/* Central Core */}\n      <motion.div\n        className=\"relative w-32 h-32 rounded-full z-10\"\n        style={{\n          background: `radial-gradient(circle at 30% 30%, ${colorStart}, ${colorEnd})`,\n        }}\n        animate={{\n          scale: [1, 1.06, 1],\n          rotate: [0, 5, -5, 0],\n        }}\n        transition={{ duration: 4, repeat: Infinity }}\n        whileHover={{ scale: 1.12 }}\n      >\n        {/* Core glow */}\n        <motion.div\n          className=\"absolute inset-0 rounded-full blur-2xl\"\n          style={{\n            background: `radial-gradient(circle, COLORS.sky[80], transparent)`,\n          }}\n          animate={{\n            scale: [1, 1.5, 1],\n            opacity: [0.5, 0.9, 0.5],\n          }}\n          transition={{ duration: 3, repeat: Infinity }}\n        />\n\n        {/* Core icon */}\n        <div className=\"absolute inset-0 flex flex-col items-center justify-center text-center\">\n          <motion.div\n            className=\"text-5xl\"\n            animate={{\n              scale: [1, 1.15, 1],\n              rotate: [0, 10, -10, 0],\n            }}\n            transition={{ duration: 3, repeat: Infinity }}\n          >\n            {icon}\n          </motion.div>\n        </div>\n      </motion.div>\n\n      {/* Stat orbs in orbital arrangement */}\n      <TextStatOrb\n        value={textStats.textCount}\n        label=\"Textos\"\n        icon=\"üìÑ\"\n        color=\"#06B6D4\"\n        angle={-90}\n        distance={120}\n        delay={0}\n      />\n\n      <TextStatOrb\n        value={textStats.wordsRead.toLocaleString()}\n        label=\"Palabras\"\n        icon=\"üìù\"\n        color=\"#22D3EE\"\n        angle={30}\n        distance={120}\n        delay={0.1}\n      />\n\n      <TextStatOrb\n        value={`${textStats.hoursRead}h`}\n        label=\"Horas\"\n        icon=\"‚è±Ô∏è\"\n        color=\"#67E8F9\"\n        angle={150}\n        distance={120}\n        delay={0.2}\n      />\n\n      {/* Floating particles */}\n      {[0, 1, 2, 3, 4, 5].map((i) => (\n        <motion.div\n          key={`text-particle-${i}`}\n          className=\"absolute w-2 h-2 rounded-full opacity-70\"\n          style={{\n            background: i % 2 === 0 ? '#06B6D4' : '#22D3EE',\n            left: `${25 + (i * 8) % 50}%`,\n            top: `${15 + (i * 10) % 70}%`,\n          }}\n          animate={{\n            y: [0, -50, 0],\n            x: [0, i % 2 === 0 ? 30 : -30, 0],\n            scale: [1, 0.6, 1],\n            opacity: [0.7, 0.3, 0.7],\n          }}\n          transition={{\n            duration: 6 + i,\n            repeat: Infinity,\n            ease: 'easeInOut',\n            delay: i * 0.3,\n          }}\n        />\n      ))}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/TextInputSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/TextStatsOrb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/YouTubePlayer.tsx","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'YouTubePlayer' has too many lines (133). Maximum allowed is 120.","line":48,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":180,"endColumn":2},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":56,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1430,1433],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1430,1433],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3723,3726],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3723,3726],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useEffect, useRef, useState, useCallback } from 'react';\n\ninterface YouTubePlayerProps {\n  videoId: string;\n  onTimeUpdate?: (currentTime: number, duration: number) => void;\n  onPlay?: () => void;\n  onPause?: () => void;\n  onEnd?: () => void;\n}\n\n// Singleton para cargar YouTube API solo una vez\nlet youtubeAPILoading = false;\nconst youtubeAPIReadyCallbacks: (() => void)[] = [];\n\nfunction loadYouTubeAPI(): Promise<void> {\n  return new Promise((resolve) => {\n    if (window.YT?.Player) {\n      resolve();\n      return;\n    }\n\n    if (youtubeAPILoading) {\n      youtubeAPIReadyCallbacks.push(() => resolve());\n      return;\n    }\n\n    youtubeAPILoading = true;\n    const tag = document.createElement('script');\n    tag.src = 'https://www.youtube.com/iframe_api';\n    tag.async = true;\n    tag.defer = true;\n    \n    const firstScriptTag = document.getElementsByTagName('script')[0];\n    firstScriptTag.parentNode?.insertBefore(tag, firstScriptTag);\n\n    window.onYouTubeIframeAPIReady = () => {\n      youtubeAPILoading = false;\n      resolve();\n      // Ejecutar todos los callbacks pendientes\n      youtubeAPIReadyCallbacks.forEach((cb) => cb());\n      youtubeAPIReadyCallbacks.length = 0;\n    };\n  });\n}\n\nexport function YouTubePlayer({\n  videoId,\n  onTimeUpdate,\n  onPlay,\n  onPause,\n  onEnd,\n}: YouTubePlayerProps) {\n  const playerRef = useRef<HTMLDivElement>(null);\n  const playerInstanceRef = useRef<any>(null);\n  const [isReady, setIsReady] = useState(false);\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Memoizar callbacks para evitar re-renders\n  const handleTimeUpdate = useCallback(\n    (current: number, duration: number) => {\n      onTimeUpdate?.(current, duration);\n    },\n    [onTimeUpdate]\n  );\n\n  const handlePlay = useCallback(() => {\n    onPlay?.();\n  }, [onPlay]);\n\n  const handlePause = useCallback(() => {\n    onPause?.();\n  }, [onPause]);\n\n  const handleEnd = useCallback(() => {\n    onEnd?.();\n  }, [onEnd]);\n\n  // Cargar YouTube API solo una vez\n  useEffect(() => {\n    loadYouTubeAPI().then(() => {\n      setIsReady(true);\n    });\n  }, []);\n\n  // Inicializar player cuando la API est√° lista\n  useEffect(() => {\n    if (!isReady || !playerRef.current || !videoId) return;\n\n    // Limpiar player anterior si existe\n    if (playerInstanceRef.current) {\n      try {\n        playerInstanceRef.current.destroy();\n      } catch {\n        // Ignorar errores\n      }\n      playerInstanceRef.current = null;\n    }\n\n    // Limpiar intervalo anterior\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n\n    try {\n      if (!window.YT) {\n      return;\n    }\n\n    const player = new window.YT.Player(playerRef.current, {\n        videoId,\n        playerVars: {\n          autoplay: 0,\n          controls: 1,\n          rel: 0,\n          modestbranding: 1,\n          enablejsapi: 1,\n          origin: typeof window !== 'undefined' ? window.location.origin : '',\n        },\n        events: {\n          onReady: () => {\n            // Iniciar tracking de tiempo solo cuando el player est√° listo\n            intervalRef.current = setInterval(() => {\n              if (playerInstanceRef.current) {\n                try {\n                  const currentTime = playerInstanceRef.current.getCurrentTime();\n                  const duration = playerInstanceRef.current.getDuration();\n                  if (currentTime > 0 && duration > 0) {\n                    handleTimeUpdate(currentTime, duration);\n                  }\n                } catch {\n                  // Ignorar errores si el player no est√° disponible\n                }\n              }\n            }, 1000);\n          },\n          onStateChange: (event: any) => {\n            if (event.data === 1) { // YT.PlayerState.PLAYING\n              handlePlay();\n            } else if (event.data === 2) { // YT.PlayerState.PAUSED\n              handlePause();\n            } else if (event.data === 0) { // YT.PlayerState.ENDED\n              handleEnd();\n            }\n          },\n        },\n      });\n\n      playerInstanceRef.current = player;\n    } catch {\n    }\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n        intervalRef.current = null;\n      }\n      if (playerInstanceRef.current) {\n        try {\n          playerInstanceRef.current.destroy();\n        } catch {\n          // Ignorar errores al destruir\n        }\n        playerInstanceRef.current = null;\n      }\n    };\n  }, [isReady, videoId, handleTimeUpdate, handlePlay, handlePause, handleEnd]);\n\n  if (!videoId) {\n    return null;\n  }\n\n  return (\n    <div className=\"w-full aspect-video bg-black rounded-lg overflow-hidden\">\n      <div ref={playerRef} className=\"w-full h-full\" />\n    </div>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/text/BlockSelector.tsx","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'BlockSelector' has too many lines (159). Maximum allowed is 120.","line":50,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":208,"endColumn":2},{"ruleId":"complexity","severity":1,"message":"Function 'BlockSelector' has a complexity of 19. Maximum allowed is 15.","line":50,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":208,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport type { TextBlock } from '@/hooks/input/useTextImport';\nimport { INPUT_COLORS } from '@/lib/constants';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface BlockSelectorProps {\n  blocks: TextBlock[];\n  onSelectionChange: (selectedBlocks: TextBlock[]) => void;\n  maxSelectable?: number;\n  showExercisePreview?: boolean;\n  disabled?: boolean;\n}\n\nexport interface SelectionState {\n  [blockId: string]: boolean;\n}\n\n// ============================================================\n// CONSTANTS\n// ============================================================\n\n// Exercise config using centralized colors\nconst EXERCISE_CONFIG = {\n  cloze: { label: 'Espacios en blanco', icon: 'üî§', color: INPUT_COLORS.video.textColor },\n  variations: { label: 'Variaciones', icon: 'üîÑ', color: INPUT_COLORS.text.textColor },\n  conversationalEcho: { label: 'Eco conversacional', icon: 'üîÅ', color: INPUT_COLORS.audio.textColor },\n  janusComposer: { label: 'Constructor de frases', icon: 'üß©', color: 'text-purple-400' },\n} as const;\n\n// ============================================================\n// COMPONENT\n// ============================================================\n\n/**\n * BlockSelector - Selector de bloques de texto para importar\n *\n * Caracter√≠sticas:\n * - Checkbox para cada bloque\n * - Selecci√≥n individual o \"select all\"\n * - Vista previa de ejercicios por bloque\n * - Resumen de selecci√≥n\n * - L√≠mite m√°ximo de selecci√≥n\n */\nexport function BlockSelector({\n  blocks,\n  onSelectionChange,\n  maxSelectable,\n  showExercisePreview = true,\n  disabled = false,\n}: BlockSelectorProps) {\n  const [selection, setSelection] = useState<SelectionState>({});\n  const [showAll, setShowAll] = useState(false);\n\n  // Calcular bloques seleccionados\n  const selectedBlocks = useMemo(() => {\n    return blocks.filter(block => selection[block.id]);\n  }, [blocks, selection]);\n\n  const selectedCount = selectedBlocks.length;\n  const isAllSelected = selectedCount === blocks.length && blocks.length > 0;\n  const isSomeSelected = selectedCount > 0 && selectedCount < blocks.length;\n  const canSelectMore = !maxSelectable || selectedCount < maxSelectable;\n\n  // Calcular ejercicios totales\n  const totalExercises = useMemo(() => {\n    return selectedBlocks.reduce((sum, block) => {\n      return sum + Math.ceil(block.wordCount / 10); // ~1 ejercicio cada 10 palabras\n    }, 0);\n  }, [selectedBlocks]);\n\n  // Manejar cambio de selecci√≥n individual\n  const handleToggleBlock = (blockId: string) => {\n    if (disabled) return;\n\n    const wasSelected = selection[blockId];\n    if (wasSelected) {\n      // Deseleccionar\n      const newSelection = { ...selection, [blockId]: false };\n      setSelection(newSelection);\n      onSelectionChange(blocks.filter(b => newSelection[b.id]));\n    } else if (canSelectMore) {\n      // Seleccionar\n      const newSelection = { ...selection, [blockId]: true };\n      setSelection(newSelection);\n      onSelectionChange(blocks.filter(b => newSelection[b.id]));\n    }\n  };\n\n  // Manejar \"select all\"\n  const handleToggleAll = () => {\n    if (disabled) return;\n\n    if (isAllSelected || isSomeSelected) {\n      // Deseleccionar todos\n      setSelection({});\n      onSelectionChange([]);\n    } else {\n      // Seleccionar todos (respetando maxSelectable)\n      const limit = maxSelectable || blocks.length;\n      const newSelection: SelectionState = {};\n      blocks.slice(0, limit).forEach(block => {\n        newSelection[block.id] = true;\n      });\n      setSelection(newSelection);\n      onSelectionChange(blocks.slice(0, limit));\n    }\n  };\n\n  // Bloques a mostrar (con opci√≥n de \"ver m√°s\")\n  const displayedBlocks = showAll ? blocks : blocks.slice(0, 5);\n  const hasMoreBlocks = blocks.length > 5;\n\n  return (\n    <div className=\"w-full space-y-4\">\n      {/* Header con acciones */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-white\">\n            Seleccionar Bloques\n          </h3>\n          <p className=\"text-sm text-calm-text-muted\">\n            {selectedCount > 0\n              ? `${selectedCount} de ${blocks.length} bloques seleccionados`\n              : `${blocks.length} bloques disponibles`}\n          </p>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {/* Select All */}\n          {blocks.length > 1 && (\n            <motion.button\n              onClick={handleToggleAll}\n              disabled={disabled}\n              className={`\n                px-4 py-2 rounded-lg text-sm font-medium transition-colors\n                ${isAllSelected || isSomeSelected\n                  ? 'INPUT_COLORS.audio.bgDark hover:bg-amber-700 text-white'\n                  : 'bg-calm-bg-elevated hover:bg-calm-warm-200/20 text-calm-text-primary border border-calm-warm-200/50'\n                }\n                ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n              `}\n              whileHover={{ scale: disabled ? 1 : 1.02 }}\n              whileTap={{ scale: disabled ? 1 : 0.98 }}\n            >\n              {isAllSelected ? '‚úì Todos' : isSomeSelected ? '‚úì Algunos' : 'Seleccionar todos'}\n            </motion.button>\n          )}\n        </div>\n      </div>\n\n      {/* Resumen de selecci√≥n */}\n      <AnimatePresence>\n        {selectedCount > 0 && (\n          <SelectionSummary\n            selectedCount={selectedCount}\n            totalWords={selectedBlocks.reduce((sum, b) => sum + b.wordCount, 0)}\n            totalExercises={totalExercises}\n          />\n        )}\n      </AnimatePresence>\n\n      {/* Lista de bloques */}\n      <div className=\"space-y-3\">\n        {displayedBlocks.map((block, index) => (\n          <BlockCard\n            key={block.id}\n            block={block}\n            isSelected={selection[block.id] || false}\n            onToggle={() => handleToggleBlock(block.id)}\n            showExercisePreview={showExercisePreview}\n            disabled={disabled || (!selection[block.id] && !canSelectMore)}\n            index={index}\n          />\n        ))}\n      </div>\n\n      {/* Bot√≥n \"ver m√°s\" */}\n      {hasMoreBlocks && !showAll && (\n        <motion.button\n          onClick={() => setShowAll(true)}\n          className=\"w-full py-2 text-sm INPUT_COLORS.text.textColor hover:INPUT_COLORS.text.textHover transition-colors\"\n          whileHover={{ scale: 1.02 }}\n          whileTap={{ scale: 0.98 }}\n        >\n          Ver {blocks.length - 5} bloques m√°s ‚Üì\n        </motion.button>\n      )}\n\n      {/* Advertencia de l√≠mite */}\n      {maxSelectable && selectedCount >= maxSelectable && (\n        <motion.div\n          initial={{ opacity: 0, y: -10 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"p-3 INPUT_COLORS.audio.bgSubtle border INPUT_COLORS.audio.borderColor.replace('/30', '')/30 rounded-lg\"\n        >\n          <p className=\"text-sm INPUT_COLORS.audio.textColor\">\n            ‚ö†Ô∏è Has alcanzado el l√≠mite de {maxSelectable} bloques\n          </p>\n        </motion.div>\n      )}\n    </div>\n  );\n}\n\n// ============================================================\n// SUBCOMPONENTS\n// ============================================================\n\ninterface SelectionSummaryProps {\n  selectedCount: number;\n  totalWords: number;\n  totalExercises: number;\n}\n\nfunction SelectionSummary({ selectedCount, totalWords, totalExercises }: SelectionSummaryProps) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -10 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: -10 }}\n      className=\"p-4 INPUT_COLORS.text.bgSubtle border INPUT_COLORS.text.borderColor.replace('/30', '')/30 rounded-xl\"\n    >\n      <div className=\"grid grid-cols-3 gap-4 text-center\">\n        <div>\n          <p className=\"text-2xl font-bold INPUT_COLORS.text.textColor\">{selectedCount}</p>\n          <p className=\"text-xs INPUT_COLORS.text.textHover/70\">Bloques</p>\n        </div>\n        <div>\n          <p className=\"text-2xl font-bold INPUT_COLORS.video.textColor\">{totalWords.toLocaleString()}</p>\n          <p className=\"text-xs text-sky-300/70\">Palabras</p>\n        </div>\n        <div>\n          <p className=\"text-2xl font-bold INPUT_COLORS.audio.textColor\">{totalExercises}</p>\n          <p className=\"text-xs text-amber-300/70\">Ejercicios</p>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\ninterface BlockCardProps {\n  block: TextBlock;\n  isSelected: boolean;\n  onToggle: () => void;\n  showExercisePreview: boolean;\n  disabled: boolean;\n  index: number;\n}\n\nfunction BlockCard({ block, isSelected, onToggle, showExercisePreview, disabled, index }: BlockCardProps) {\n  // Estimar ejercicios para este bloque\n  const exerciseCount = Math.ceil(block.wordCount / 10);\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ delay: index * 0.05 }}\n      className={`\n        relative p-4 rounded-xl border-2 transition-all duration-200\n        ${isSelected\n          ? `${INPUT_COLORS.text.bgSubtle} ${INPUT_COLORS.text.borderColor.replace('/30', '/50')}`\n          : 'bg-calm-bg-elevated/50 border-calm-warm-200/50 hover:border-calm-warm-200'\n        }\n        ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n      `}\n      onClick={disabled ? undefined : onToggle}\n      role=\"checkbox\"\n      aria-checked={isSelected}\n      tabIndex={disabled ? -1 : 0}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          e.preventDefault();\n          onToggle();\n        }\n      }}\n    >\n      {/* Checkbox */}\n      <div className=\"flex items-start gap-4\">\n        <div className={`\n          flex-shrink-0 w-6 h-6 rounded border-2 flex items-center justify-center transition-colors\n          ${isSelected\n            ? `${INPUT_COLORS.text.bgDark} ${INPUT_COLORS.text.borderColor.replace('/30', '')}`\n            : 'border-calm-warm-200 bg-calm-bg-tertiary'\n          }\n        `}>\n          {isSelected && (\n            <motion.span\n              initial={{ scale: 0 }}\n              animate={{ scale: 1 }}\n              className=\"text-white text-sm\"\n            >\n              ‚úì\n            </motion.span>\n          )}\n        </div>\n\n        {/* Contenido */}\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <h4 className=\"text-sm font-medium text-white\">\n              Bloque {index + 1}\n            </h4>\n            <div className=\"flex items-center gap-3 text-xs text-calm-text-muted\">\n              <span>{block.wordCount} palabras</span>\n              <span>~{block.estimatedReadingTime}s lectura</span>\n            </div>\n          </div>\n\n          <p className=\"text-sm text-calm-text-primary line-clamp-3 mb-3\">\n            {block.content}\n          </p>\n\n          {/* Ejercicios preview */}\n          {showExercisePreview && (\n            <div className=\"flex flex-wrap gap-2\">\n              {Object.entries(EXERCISE_CONFIG).slice(0, 3).map(([key, config]) => {\n                const count = Math.ceil(exerciseCount / 4);\n                return (\n                  <span\n                    key={key}\n                    className={`inline-flex items-center gap-1 px-2 py-1 rounded-md bg-calm-bg-tertiary ${config.color} text-xs`}\n                  >\n                    <span>{config.icon}</span>\n                    <span>{count}</span>\n                  </span>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Glow effect cuando seleccionado */}\n      {isSelected && (\n        <motion.div\n          className={`absolute inset-0 rounded-xl ${INPUT_COLORS.text.bgDark.replace('bg-', 'bg-').replace('-600', '/10')} pointer-events-none`}\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          transition={{ duration: 0.2 }}\n        />\n      )}\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/text/TextEditor.tsx","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'TextEditor' has too many lines (220). Maximum allowed is 120.","line":57,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":276,"endColumn":2},{"ruleId":"complexity","severity":1,"message":"Function 'TextEditor' has a complexity of 25. Maximum allowed is 15.","line":57,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":276,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { PROGRESS_COLORS, INPUT_COLORS } from '@/lib/constants';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface TextEditorProps {\n  value: string;\n  onChange: (value: string) => void;\n  maxLength?: number;\n  minLength?: number;\n  placeholder?: string;\n  disabled?: boolean;\n  autoFocus?: boolean;\n  showCharacterCount?: boolean;\n  onPaste?: (text: string) => void;\n}\n\nexport interface TextEditorRef {\n  focus: () => void;\n  selectAll: () => void;\n  insertText: (text: string) => void;\n  clear: () => void;\n}\n\n// ============================================================\n// CONSTANTS\n// ============================================================\n\nconst DEFAULT_MAX_LENGTH = 10_000;\nconst DEFAULT_MIN_LENGTH = 20;\n\nconst CHARACTER_WARNING_THRESHOLDS = {\n  nearLimit: 0.9,  // 90% of max length\n  atLimit: 1.0,    // 100% of max length\n} as const;\n\n// ============================================================\n// COMPONENT\n// ============================================================\n\n/**\n * TextEditor - Editor de texto con l√≠nea de caracteres\n *\n * Caracter√≠sticas:\n * - L√≠mite de caracteres configurable (default: 10,000)\n * - L√≠nea visual de progreso de caracteres\n * - Contador de caracteres y palabras\n * - Soporte para paste con limpieza de formato\n * - Indicadores de advertencia (cerca/at del l√≠mite)\n * - Accesibilidad con ARIA\n */\nexport function TextEditor({\n  value,\n  onChange,\n  maxLength = DEFAULT_MAX_LENGTH,\n  minLength = DEFAULT_MIN_LENGTH,\n  placeholder = 'Pega aqu√≠ tu texto en franc√©s para analizar...',\n  disabled = false,\n  autoFocus = false,\n  showCharacterCount = true,\n  onPaste,\n}: TextEditorProps) {\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const [isFocused, setIsFocused] = useState(false);\n  const [wordCount, setWordCount] = useState(0);\n\n  // Calcular estad√≠sticas\n  const charCount = value.length;\n  const charPercentage = charCount / maxLength;\n  const isNearLimit = charPercentage >= CHARACTER_WARNING_THRESHOLDS.nearLimit;\n  const isAtLimit = charPercentage >= CHARACTER_WARNING_THRESHOLDS.atLimit;\n  const isBelowMin = charCount > 0 && charCount < minLength;\n\n  // Actualizar conteo de palabras\n  useEffect(() => {\n    const words = value.trim().split(/\\s+/).filter(w => w.length > 0);\n    setWordCount(words.length);\n  }, [value]);\n\n  // Auto focus si se solicita\n  useEffect(() => {\n    if (autoFocus && textareaRef.current) {\n      textareaRef.current.focus();\n    }\n  }, [autoFocus]);\n\n  // Manejar cambio de texto\n  const handleChange = useCallback((e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    const newValue = e.target.value;\n    if (newValue.length <= maxLength) {\n      onChange(newValue);\n    }\n  }, [maxLength, onChange]);\n\n  // Manejar paste con limpieza de formato\n  const handlePaste = useCallback((e: React.ClipboardEvent<HTMLTextAreaElement>) => {\n    e.preventDefault();\n    const pastedText = e.clipboardData.getData('text/plain');\n\n    // Limpiar texto: eliminar espacios extras, normalizar l√≠neas\n    const cleanedText = pastedText\n      .trim()\n      .replace(/\\s+/g, ' ')\n      .replace(/\\n{3,}/g, '\\n\\n');\n\n    // Insertar en la posici√≥n del cursor o al final\n    const textarea = e.currentTarget;\n    const start = textarea.selectionStart;\n    const end = textarea.selectionEnd;\n    const currentValue = value;\n    const newValue =\n      currentValue.substring(0, start) + cleanedText + currentValue.substring(end);\n\n    if (newValue.length <= maxLength) {\n      onChange(newValue);\n\n      // Mover cursor al final del texto pegado\n      requestAnimationFrame(() => {\n        const newCursorPos = start + cleanedText.length;\n        textarea.setSelectionRange(newCursorPos, newCursorPos);\n      });\n\n      // Callback externo si existe\n      onPaste?.(cleanedText);\n    }\n  }, [maxLength, value, onChange, onPaste]);\n\n  // Exponer m√©todos v√≠a ref\n  useEffect(() => {\n    if (textareaRef.current) {\n      const ref: TextEditorRef = {\n        focus: () => textareaRef.current?.focus(),\n        selectAll: () => textareaRef.current?.select(),\n        insertText: (text: string) => {\n          const textarea = textareaRef.current;\n          if (!textarea) return;\n          const start = textarea.selectionStart;\n          const end = textarea.selectionEnd;\n          const newValue =\n            value.substring(0, start) + text + value.substring(end);\n          if (newValue.length <= maxLength) {\n            onChange(newValue);\n          }\n        },\n        clear: () => onChange(''),\n      };\n      // @ts-expect-error - Custom ref attachment\n      textareaRef.current.customRef = ref;\n    }\n  }, [value, maxLength, onChange]);\n\n  // Colores de la l√≠nea de progreso - usando constantes centralizadas\n  const getLineColor = () => {\n    if (isAtLimit) return PROGRESS_COLORS.error;\n    if (isNearLimit) return PROGRESS_COLORS.warning;\n    return PROGRESS_COLORS.normal;\n  };\n\n  return (\n    <div className=\"w-full space-y-3\">\n      {/* Editor */}\n      <div\n        className={`\n          relative rounded-xl overflow-hidden border-2 transition-all duration-300\n          ${isFocused ? `${INPUT_COLORS.text.borderColor.replace('/30', '/50')} shadow-lg ${INPUT_COLORS.text.focusRing}` : 'border-calm-warm-200/50'}\n          ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n          ${isBelowMin ? PROGRESS_COLORS.warning.replace('bg-', 'border-').replace('-500', '-500/50') : ''}\n        `}\n      >\n        <textarea\n          ref={textareaRef}\n          value={value}\n          onChange={handleChange}\n          onPaste={handlePaste}\n          onFocus={() => setIsFocused(true)}\n          onBlur={() => setIsFocused(false)}\n          disabled={disabled}\n          placeholder={placeholder}\n          maxLength={maxLength}\n          className={`\n            w-full min-h-[300px] p-4 bg-calm-bg-elevated/50\n            text-calm-text-primary placeholder:text-calm-text-muted\n            resize-y focus:outline-none transition-colors\n            ${disabled ? 'cursor-not-allowed' : ''}\n          `}\n          aria-label=\"Editor de texto para importar contenido\"\n          aria-describedby=\"char-count\"\n          aria-invalid={isBelowMin || isAtLimit}\n          aria-required={true}\n        />\n\n        {/* L√≠nea de progreso de caracteres */}\n        <motion.div\n          className={`absolute bottom-0 left-0 h-1 ${getLineColor()}`}\n          initial={{ width: 0 }}\n          animate={{ width: `${charPercentage * 100}%` }}\n          transition={{ duration: 0.2 }}\n          aria-hidden=\"true\"\n        />\n      </div>\n\n      {/* Informaci√≥n de caracteres y palabras */}\n      {showCharacterCount && (\n        <div className=\"flex items-center justify-between text-sm\">\n          <div className=\"flex items-center gap-4\">\n            {/* Contador de caracteres */}\n            <motion.span\n              className={`\n                font-medium tabular-nums\n                ${isAtLimit ? PROGRESS_COLORS.textError : isNearLimit ? PROGRESS_COLORS.textWarning : PROGRESS_COLORS.textNormal}\n              `}\n              animate={isAtLimit ? { scale: [1, 1.05, 1] } : {}}\n              transition={{ duration: 0.3, repeat: isAtLimit ? Infinity : 0 }}\n              id=\"char-count\"\n            >\n              {charCount.toLocaleString()} / {maxLength.toLocaleString()} caracteres\n            </motion.span>\n\n            {/* Contador de palabras */}\n            <span className=\"text-calm-text-muted tabular-nums\">\n              {wordCount.toLocaleString()} {wordCount === 1 ? 'palabra' : 'palabras'}\n            </span>\n          </div>\n\n          {/* Advertencias */}\n          {(isBelowMin || isNearLimit || isAtLimit) && (\n            <motion.span\n              className={`\n                text-xs font-medium\n                ${isAtLimit ? PROGRESS_COLORS.textError : isBelowMin || isNearLimit ? PROGRESS_COLORS.textWarning : ''}\n              `}\n              initial={{ opacity: 0, y: -5 }}\n              animate={{ opacity: 1, y: 0 }}\n            >\n              {isAtLimit && '‚ö†Ô∏è L√≠mite alcanzado'}\n              {isNearLimit && !isAtLimit && '‚ö†Ô∏è Cerca del l√≠mite'}\n              {isBelowMin && `M√≠nimo ${minLength} caracteres`}\n            </motion.span>\n          )}\n        </div>\n      )}\n\n      {/* Acciones r√°pidas */}\n      {!disabled && value.length > 0 && (\n        <div className=\"flex items-center gap-2\">\n          <button\n            type=\"button\"\n            onClick={() => onChange('')}\n            className=\"px-3 py-1.5 text-sm text-calm-text-muted hover:text-white hover:bg-calm-warm-200/20 rounded-lg transition-colors\"\n            aria-label=\"Limpiar texto\"\n          >\n            üóëÔ∏è Limpiar\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => {\n              if (textareaRef.current) {\n                textareaRef.current.select();\n                navigator.clipboard.writeText(value);\n              }\n            }}\n            className=\"px-3 py-1.5 text-sm text-calm-text-muted hover:text-white hover:bg-calm-warm-200/20 rounded-lg transition-colors\"\n            aria-label=\"Copiar todo\"\n          >\n            üìã Copiar\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// ============================================================\n// FORWARD REF HELPER\n// ============================================================\n\n/**\n * useTextEditorRef - Hook para acceder a m√©todos del editor\n *\n * @example\n * const editorRef = useTextEditorRef();\n * <TextEditor ref={editorRef} ... />\n * <button onClick={() => editorRef.current?.focus()}>Focus</button>\n */\nexport function useTextEditorRef() {\n  const ref = useRef<TextEditorRef>(null);\n  return ref;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/text/TextPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PROGRESS_COLORS' is defined but never used.","line":5,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":58},{"ruleId":"complexity","severity":1,"message":"Function 'TextPreview' has a complexity of 16. Maximum allowed is 15.","line":44,"column":8,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":133,"endColumn":2},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'difficulty' is defined but never used. Allowed unused args must match /^_/u.","line":235,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":235,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { motion, AnimatePresence } from 'framer-motion';\nimport type { TextImportData, DifficultyLevel } from '@/hooks/input/useTextImport';\nimport { DIFFICULTY_COLORS, INPUT_COLORS, PROGRESS_COLORS } from '@/lib/constants';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface TextPreviewProps {\n  data: TextImportData | null;\n  isLoading: boolean;\n  error: string | null;\n  onAnalyze?: () => void;\n  showAnalyzeButton?: boolean;\n}\n\n// ============================================================\n// CONSTANTS\n// ============================================================\n\nconst READING_SPEED_WPM = 200; // Palabras por minuto\n\n// Helper function to get difficulty config from centralized constants\nfunction getDifficultyConfig(level: DifficultyLevel) {\n  return DIFFICULTY_COLORS[level];\n}\n\n// ============================================================\n// COMPONENTS\n// ============================================================\n\n/**\n * TextPreview - Panel de previsualizaci√≥n y an√°lisis de texto\n *\n * Muestra:\n * - Estad√≠sticas del texto (palabras, frases, idioma)\n * - Nivel de dificultad estimado\n * - Tiempo de lectura estimado\n * - T√≠tulo sugerido\n * - Estado de carga y errores\n */\nexport function TextPreview({\n  data,\n  isLoading,\n  error,\n  onAnalyze,\n  showAnalyzeButton = false,\n}: TextPreviewProps) {\n  const hasData = data !== null;\n  const difficulty = data?.difficulty ? getDifficultyConfig(data.difficulty) : null;\n  const readingTime = data ? Math.ceil(data.wordCount / READING_SPEED_WPM) : 0;\n\n  return (\n    <div className=\"w-full space-y-4\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-lg font-semibold text-white\">An√°lisis del Texto</h2>\n        {showAnalyzeButton && onAnalyze && (\n          <motion.button\n            onClick={onAnalyze}\n            disabled={isLoading}\n            className={`px-4 py-2 ${INPUT_COLORS.text.bgDark} hover:${INPUT_COLORS.text.textDark.replace('text-', 'bg-').replace('-600', '-700')} disabled:bg-slate-600 disabled:cursor-not-allowed text-white rounded-lg text-sm font-medium transition-colors`}\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n          >\n            {isLoading ? 'Analizando...' : 'Analizar'}\n          </motion.button>\n        )}\n      </div>\n\n      {/* Loading State */}\n      {isLoading && (\n        <LoadingState />\n      )}\n\n      {/* Error State */}\n      <AnimatePresence>\n        {error && !isLoading && (\n          <ErrorState message={error} />\n        )}\n      </AnimatePresence>\n\n      {/* Empty State */}\n      <AnimatePresence>\n        {!hasData && !isLoading && !error && (\n          <EmptyState />\n        )}\n      </AnimatePresence>\n\n      {/* Analysis Results */}\n      <AnimatePresence>\n        {hasData && !isLoading && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -20 }}\n            transition={{ duration: 0.3 }}\n            className=\"space-y-4\"\n          >\n            {/* Main Stats Grid */}\n            <StatsGrid\n              wordCount={data.wordCount}\n              phraseCount={data.phraseCount}\n              readingTime={readingTime}\n              blockCount={data.blocks.length}\n            />\n\n            {/* Difficulty Badge */}\n            {difficulty && (\n              <DifficultyBadge\n                difficulty={data.difficulty}\n                config={difficulty}\n              />\n            )}\n\n            {/* Language and Title */}\n            <MetadataSection\n              language={data.language}\n              suggestedTitle={data.suggestedTitle}\n            />\n\n            {/* Blocks Preview */}\n            {data.blocks.length > 0 && (\n              <BlocksPreview blocks={data.blocks} />\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\n// ============================================================\n// SUBCOMPONENTS\n// ============================================================\n\nfunction LoadingState() {\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"p-6 bg-calm-bg-elevated/50 border border-calm-warm-200/50 rounded-xl text-center\"\n    >\n      <div className=\"inline-flex items-center gap-3 text-calm-text-muted\">\n        <motion.div\n          className={`w-5 h-5 border-2 ${INPUT_COLORS.text.borderColor.replace('/30', '')} border-t-transparent rounded-full`}\n          animate={{ rotate: 360 }}\n          transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n        />\n        <span>Analizando texto...</span>\n      </div>\n    </motion.div>\n  );\n}\n\nfunction ErrorState({ message }: { message: string }) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -10 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: -10 }}\n      className=\"p-4 bg-red-900/20 border border-red-500/30 rounded-xl\"\n    >\n      <div className=\"flex items-start gap-3\">\n        <span className=\"text-red-400 text-xl\">‚ö†Ô∏è</span>\n        <div>\n          <p className=\"text-red-400 font-medium\">Error</p>\n          <p className=\"text-red-300/80 text-sm mt-1\">{message}</p>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n\nfunction EmptyState() {\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      className=\"p-8 bg-calm-bg-elevated/30 border border-dashed border-calm-warm-200/30 rounded-xl text-center\"\n    >\n      <span className=\"text-4xl mb-3 block opacity-50\">üìù</span>\n      <p className=\"text-calm-text-muted\">\n        Pega un texto para ver el an√°lisis aqu√≠\n      </p>\n      <p className=\"text-calm-text-muted/70 text-sm mt-1\">\n        M√≠nimo 20 caracteres, m√°ximo 10,000\n      </p>\n    </motion.div>\n  );\n}\n\ninterface StatsGridProps {\n  wordCount: number;\n  phraseCount: number;\n  readingTime: number;\n  blockCount: number;\n}\n\nfunction StatsGrid({ wordCount, phraseCount, readingTime, blockCount }: StatsGridProps) {\n  // Use centralized colors for stats\n  const stats = [\n    { label: 'Palabras', value: wordCount.toLocaleString(), icon: 'üìÑ', color: INPUT_COLORS.video.textColor },\n    { label: 'Frases', value: phraseCount.toLocaleString(), icon: 'üí¨', color: INPUT_COLORS.text.textColor },\n    { label: 'Lectura', value: `~${readingTime} min`, icon: '‚è±Ô∏è', color: INPUT_COLORS.audio.textColor },\n    { label: 'Bloques', value: blockCount.toString(), icon: 'üì¶', color: 'text-purple-400' },\n  ];\n\n  return (\n    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n      {stats.map((stat, index) => (\n        <motion.div\n          key={stat.label}\n          initial={{ opacity: 0, scale: 0.9 }}\n          animate={{ opacity: 1, scale: 1 }}\n          transition={{ delay: index * 0.1 }}\n          className=\"p-4 bg-calm-bg-elevated/50 border border-calm-warm-200/30 rounded-xl\"\n        >\n          <div className=\"flex items-center gap-2 mb-2\">\n            <span className=\"text-xl\" aria-hidden=\"true\">{stat.icon}</span>\n            <span className=\"text-xs text-calm-text-muted\">{stat.label}</span>\n          </div>\n          <p className={`text-lg font-bold ${stat.color}`}>\n            {stat.value}\n          </p>\n        </motion.div>\n      ))}\n    </div>\n  );\n}\n\nfunction DifficultyBadge({\n  difficulty,\n  config,\n}: {\n  difficulty: DifficultyLevel;\n  config: typeof DIFFICULTY_COLORS[keyof typeof DIFFICULTY_COLORS];\n}) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      className={`\n        inline-flex items-center gap-2 px-4 py-2 rounded-lg border\n        ${config.bgColor} ${config.borderColor}\n      `}\n    >\n      <span className=\"text-lg\" aria-hidden=\"true\">{config.icon}</span>\n      <div>\n        <p className=\"text-xs text-calm-text-muted\">Dificultad estimada</p>\n        <p className={`font-semibold ${config.color}`}>{config.label}</p>\n      </div>\n    </motion.div>\n  );\n}\n\nfunction MetadataSection({\n  language,\n  suggestedTitle,\n}: {\n  language: string;\n  suggestedTitle: string;\n}) {\n  const languageNames: Record<string, string> = {\n    'fr': 'Franc√©s',\n    'fr-FR': 'Franc√©s',\n    'en': 'Ingl√©s',\n    'es': 'Espa√±ol',\n    'de': 'Alem√°n',\n    'it': 'Italiano',\n  };\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"p-3 bg-calm-bg-elevated/30 border border-calm-warm-200/20 rounded-lg\">\n        <p className=\"text-xs text-calm-text-muted mb-1\">T√≠tulo sugerido</p>\n        <p className=\"text-white font-medium\">{suggestedTitle || 'Sin t√≠tulo'}</p>\n      </div>\n      <div className=\"flex items-center gap-2 text-sm text-calm-text-muted\">\n        <span>üåç</span>\n        <span>Idioma detectado: <strong className=\"text-white\">{languageNames[language] || language}</strong></span>\n      </div>\n    </div>\n  );\n}\n\nfunction BlocksPreview({ blocks }: { blocks: Array<{ id: string; content: string; wordCount: number }> }) {\n  const previewBlocks = blocks.slice(0, 3);\n  const hasMore = blocks.length > 3;\n\n  return (\n    <div className=\"space-y-2\">\n      <p className=\"text-sm text-calm-text-muted\">\n        Vista previa de bloques ({blocks.length} total)\n      </p>\n      <div className=\"space-y-2\">\n        {previewBlocks.map((block, index) => (\n          <motion.div\n            key={block.id}\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: index * 0.1 }}\n            className=\"p-3 bg-calm-bg-elevated/30 border border-calm-warm-200/20 rounded-lg\"\n          >\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-xs text-calm-text-muted\">Bloque {index + 1}</span>\n              <span className={`text-xs ${INPUT_COLORS.text.textColor}`}>{block.wordCount} palabras</span>\n            </div>\n            <p className=\"text-sm text-calm-text-primary line-clamp-2\">\n              {block.content}\n            </p>\n          </motion.div>\n        ))}\n      </div>\n      {hasMore && (\n        <p className=\"text-xs text-calm-text-muted text-center\">\n          ... y {blocks.length - 3} bloques m√°s\n        </p>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/text/VoiceSelector.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TTSOptions' is defined but never used.","line":5,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":35},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'VoiceSelector' has too many lines (196). Maximum allowed is 120.","line":81,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":276,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport type { TTSVoice, TTSOptions } from '@/types/tts';\nimport { TTS_VOICE_PRESETS } from '@/types/tts';\nimport { INPUT_COLORS } from '@/lib/constants';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface VoiceSelectorProps {\n  selectedVoice: string;\n  onVoiceChange: (voice: string) => void;\n  onPreview?: (voice: string) => void;\n  disabled?: boolean;\n  showPreviewButton?: boolean;\n}\n\nexport interface VoicePreset {\n  id: 'beginner' | 'intermediate' | 'advanced';\n  label: string;\n  description: string;\n  icon: string;\n  voiceId: string;\n  color: string;\n  bgColor: string;\n}\n\n// ============================================================\n// CONSTANTS\n// ============================================================\n\nconst VOICE_PRESETS: VoicePreset[] = [\n  {\n    id: 'beginner',\n    label: 'Principiante',\n    description: 'Lento, claro, ideal para empezar',\n    icon: 'üå±',\n    voiceId: TTS_VOICE_PRESETS.beginner,\n    color: INPUT_COLORS.text.textColor,\n    bgColor: INPUT_COLORS.text.bg,\n  },\n  {\n    id: 'intermediate',\n    label: 'Intermedio',\n    description: 'Conversacional, expresi√≥n natural',\n    icon: 'üìö',\n    voiceId: TTS_VOICE_PRESETS.intermediate,\n    color: INPUT_COLORS.audio.textColor,\n    bgColor: INPUT_COLORS.audio.bg,\n  },\n  {\n    id: 'advanced',\n    label: 'Avanzado',\n    description: 'R√°pido, expresiones naturales',\n    icon: 'üöÄ',\n    voiceId: TTS_VOICE_PRESETS.advanced,\n    color: 'text-rose-400',\n    bgColor: 'bg-rose-500/20',\n  },\n];\n\nconst PREVIEW_TEXT = 'Bonjour, comment allez-vous?';\n\n// ============================================================\n// COMPONENT\n// ============================================================\n\n/**\n * VoiceSelector - Selector de voz TTS con presets por nivel\n *\n * Caracter√≠sticas:\n * - Presets por nivel (principiante/intermedio/avanzado)\n * - Lista completa de voces francesas\n * - Preview de voz con muestra de audio\n * - Indicadores de calidad (neural/standard)\n * - Filtros por g√©nero y categor√≠a\n */\nexport function VoiceSelector({\n  selectedVoice,\n  onVoiceChange,\n  onPreview,\n  disabled = false,\n  showPreviewButton = true,\n}: VoiceSelectorProps) {\n  const [voices, setVoices] = useState<TTSVoice[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [showAllVoices, setShowAllVoices] = useState(false);\n  const [previewingVoice, setPreviewingVoice] = useState<string | null>(null);\n  const [genderFilter, setGenderFilter] = useState<'all' | 'male' | 'female' | 'neutral'>('all');\n\n  // Cargar voces desde la API\n  useEffect(() => {\n    const fetchVoices = async () => {\n      try {\n        setIsLoading(true);\n        setError(null);\n\n        const response = await fetch('/api/tts/generate');\n        if (!response.ok) {\n          throw new Error('Failed to fetch voices');\n        }\n\n        const data = await response.json();\n        // Filtrar solo voces francesas\n        const frenchVoices = data.voices?.filter((v: TTSVoice) =>\n          v.locale?.startsWith('fr-') || v.locale?.startsWith('fr_FR')\n        ) || [];\n\n        setVoices(frenchVoices);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Failed to load voices');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchVoices();\n  }, []);\n\n  // Obtener preset activo\n  const activePreset = VOICE_PRESETS.find(p => p.voiceId === selectedVoice);\n\n  // Filtrar voces\n  const filteredVoices = voices.filter(voice => {\n    if (genderFilter === 'all') return true;\n    return voice.gender === genderFilter;\n  });\n\n  // Manejar cambio de preset\n  const handlePresetClick = useCallback((preset: VoicePreset) => {\n    if (disabled) return;\n    onVoiceChange(preset.voiceId);\n  }, [disabled, onVoiceChange]);\n\n  // Manejar preview de voz\n  const handlePreview = useCallback(async (voiceId: string) => {\n    if (disabled || previewingVoice) return;\n\n    try {\n      setPreviewingVoice(voiceId);\n\n      // Usar callback externo si existe\n      if (onPreview) {\n        await onPreview(voiceId);\n      } else {\n        // Preview por defecto usando la API\n        const response = await fetch('/api/tts/generate', {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            text: PREVIEW_TEXT,\n            voice: voiceId,\n            options: { rate: 1.0, pitch: 1.0, volume: 1.0 },\n          }),\n        });\n\n        if (!response.ok) throw new Error('Preview failed');\n\n        const data = await response.json();\n        const audio = new Audio(data.audio);\n        await audio.play();\n      }\n    } catch (err) {\n      console.error('Preview failed:', err);\n    } finally {\n      setPreviewingVoice(null);\n    }\n  }, [disabled, previewingVoice, onPreview]);\n\n  return (\n    <div className=\"w-full space-y-4\">\n      {/* Header */}\n      <div>\n        <h3 className=\"text-lg font-semibold text-white mb-1\">\n          Seleccionar Voz\n        </h3>\n        <p className=\"text-sm text-calm-text-muted\">\n          {activePreset\n            ? `Preset activo: ${activePreset.label}`\n            : 'Elige un preset o selecciona una voz espec√≠fica'\n          }\n        </p>\n      </div>\n\n      {/* Presets por nivel */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\n        {VOICE_PRESETS.map((preset) => (\n          <PresetCard\n            key={preset.id}\n            preset={preset}\n            isActive={selectedVoice === preset.voiceId}\n            onClick={() => handlePresetClick(preset)}\n            disabled={disabled}\n          />\n        ))}\n      </div>\n\n      {/* Toggle para ver todas las voces */}\n      <div className=\"flex items-center justify-between pt-2 border-t border-calm-warm-200/30\">\n        <button\n          onClick={() => setShowAllVoices(!showAllVoices)}\n          disabled={isLoading || disabled}\n          className={`text-sm ${INPUT_COLORS.text.textColor} ${INPUT_COLORS.text.textHover} disabled:opacity-50 transition-colors`}\n        >\n          {showAllVoices ? '‚Üë Ocultar todas las voces' : '‚Üì Ver todas las voces disponibles'}\n        </button>\n\n        {/* Filtro por g√©nero */}\n        {showAllVoices && (\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-xs text-calm-text-muted\">G√©nero:</span>\n            {(['all', 'female', 'male'] as const).map((filter) => (\n              <button\n                key={filter}\n                onClick={() => setGenderFilter(filter)}\n                className={`\n                  px-2 py-1 text-xs rounded transition-colors\n                  ${genderFilter === filter\n                    ? 'bg-accent-500/20 text-accent-300'\n                    : 'bg-calm-bg-elevated text-calm-text-muted hover:text-white'\n                  }\n                `}\n              >\n                {filter === 'all' ? 'Todos' : filter === 'female' ? 'Mujer' : 'Hombre'}\n              </button>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Lista completa de voces */}\n      <AnimatePresence>\n        {showAllVoices && (\n          <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: 'auto' }}\n            exit={{ opacity: 0, height: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"space-y-2 max-h-[400px] overflow-y-auto\"\n          >\n            {isLoading ? (\n              <div className=\"p-4 text-center text-calm-text-muted\">\n                Cargando voces...\n              </div>\n            ) : error ? (\n              <div className=\"p-4 bg-red-900/20 border border-red-500/30 rounded-lg text-red-400 text-sm\">\n                {error}\n              </div>\n            ) : filteredVoices.length === 0 ? (\n              <div className=\"p-4 text-center text-calm-text-muted\">\n                No se encontraron voces\n              </div>\n            ) : (\n              filteredVoices.map((voice) => (\n                <VoiceItem\n                  key={voice.shortName}\n                  voice={voice}\n                  isSelected={selectedVoice === voice.shortName}\n                  onSelect={() => onVoiceChange(voice.shortName)}\n                  onPreview={() => handlePreview(voice.shortName)}\n                  isPreviewing={previewingVoice === voice.shortName}\n                  disabled={disabled}\n                  showPreviewButton={showPreviewButton}\n                />\n              ))\n            )}\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\n// ============================================================\n// SUBCOMPONENTS\n// ============================================================\n\ninterface PresetCardProps {\n  preset: VoicePreset;\n  isActive: boolean;\n  onClick: () => void;\n  disabled: boolean;\n}\n\nfunction PresetCard({ preset, isActive, onClick, disabled }: PresetCardProps) {\n  return (\n    <motion.button\n      onClick={onClick}\n      disabled={disabled}\n      className={`\n        relative p-4 rounded-xl border-2 text-left transition-all duration-200\n        ${isActive\n          ? `${preset.bgColor} ${preset.color} border-current shadow-lg`\n          : 'bg-calm-bg-elevated/50 border-calm-warm-200/50 hover:border-calm-warm-200 text-calm-text-primary'\n        }\n        ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n      `}\n      whileHover={{ scale: disabled ? 1 : 1.02 }}\n      whileTap={{ scale: disabled ? 1 : 0.98 }}\n    >\n      {/* Icono */}\n      <div className=\"flex items-center justify-between mb-2\">\n        <span className=\"text-2xl\">{preset.icon}</span>\n        {isActive && (\n          <motion.span\n            initial={{ scale: 0 }}\n            animate={{ scale: 1 }}\n            className=\"text-lg\"\n          >\n            ‚úì\n          </motion.span>\n        )}\n      </div>\n\n      {/* Label y descripci√≥n */}\n      <h4 className={`font-semibold mb-1 ${isActive ? preset.color : 'text-white'}`}>\n        {preset.label}\n      </h4>\n      <p className=\"text-xs text-calm-text-muted\">\n        {preset.description}\n      </p>\n    </motion.button>\n  );\n}\n\ninterface VoiceItemProps {\n  voice: TTSVoice;\n  isSelected: boolean;\n  onSelect: () => void;\n  onPreview: () => void;\n  isPreviewing: boolean;\n  disabled: boolean;\n  showPreviewButton: boolean;\n}\n\nfunction VoiceItem({ voice, isSelected, onSelect, onPreview, isPreviewing, disabled, showPreviewButton }: VoiceItemProps) {\n  const quality = voice.quality || 'standard';\n  const qualityColor = quality === 'neural' ? 'text-purple-400' : 'text-calm-text-muted';\n\n  return (\n    <motion.div\n      className={`\n        p-3 rounded-lg border transition-all duration-200\n        ${isSelected\n          ? `${INPUT_COLORS.text.bgSubtle} ${INPUT_COLORS.text.borderColor.replace('/30', '/50')}`\n          : 'bg-calm-bg-elevated/30 border-calm-warm-200/30'\n        }\n      `}\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      transition={{ duration: 0.2 }}\n    >\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex-1\">\n          {/* Nombre de voz */}\n          <div className=\"flex items-center gap-2 mb-1\">\n            <span className=\"text-sm font-medium text-white\">\n              {voice.name || voice.shortName}\n            </span>\n            <span className={`text-xs px-1.5 py-0.5 rounded ${qualityColor} bg-calm-bg-tertiary`}>\n              {quality}\n            </span>\n            {voice.recommendedLevel && (\n              <span className=\"text-xs text-calm-text-muted\">\n                ({voice.recommendedLevel})\n              </span>\n            )}\n          </div>\n\n          {/* Metadatos */}\n          <div className=\"flex items-center gap-3 text-xs text-calm-text-muted\">\n            <span>{voice.gender}</span>\n            <span>{voice.locale}</span>\n          </div>\n        </div>\n\n        {/* Acciones */}\n        <div className=\"flex items-center gap-2\">\n          {/* Preview button */}\n          {showPreviewButton && (\n            <motion.button\n              onClick={(e) => {\n                e.stopPropagation();\n                onPreview();\n              }}\n              disabled={disabled || isPreviewing}\n              className=\"p-2 rounded-lg bg-calm-bg-tertiary hover:bg-calm-warm-200/20 text-calm-text-muted hover:text-white transition-colors disabled:opacity-50\"\n              whileHover={{ scale: 1.1 }}\n              whileTap={{ scale: 0.9 }}\n              aria-label=\"Escuchar muestra\"\n            >\n              {isPreviewing ? (\n                <motion.div\n                  animate={{ rotate: 360 }}\n                  transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n                  className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full\"\n                />\n              ) : (\n                <span>‚ñ∂Ô∏è</span>\n              )}\n            </motion.button>\n          )}\n\n          {/* Select button */}\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              onSelect();\n            }}\n            disabled={disabled}\n            className={`\n              px-3 py-1.5 rounded-lg text-sm font-medium transition-colors\n              ${isSelected\n                ? `${INPUT_COLORS.text.bgDark} text-white`\n                : 'bg-calm-bg-elevated text-calm-text-primary hover:bg-calm-warm-200/20'\n              }\n              ${disabled ? 'opacity-50 cursor-not-allowed' : ''}\n            `}\n          >\n            {isSelected ? '‚úì Seleccionada' : 'Seleccionar'}\n          </button>\n        </div>\n      </div>\n    </motion.div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/kepa.cantero/Projects/lingua-forge/src/components/input/video/VideoPlayer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'INPUT_COLORS' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"max-lines-per-function","severity":1,"message":"Function 'VideoPlayer' has too many lines (443). Maximum allowed is 120.","line":62,"column":8,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":504,"endColumn":2},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1835,1838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1835,1838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":119,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":119,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3264,3267],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3264,3267],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3594,3597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3594,3597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'changePlaybackRate', 'skip', 'toggleFullscreen', 'toggleMute', and 'togglePlay'. Either include them or remove the dependency array.","line":240,"column":6,"nodeType":"ArrayExpression","endLine":240,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [changePlaybackRate, isPlayerReady, skip, toggleFullscreen, toggleMute, togglePlay]","fix":{"range":[6644,6659],"text":"[changePlaybackRate, isPlayerReady, skip, toggleFullscreen, toggleMute, togglePlay]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\n\nimport { useState, useCallback, useRef, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { INPUT_COLORS } from '@/lib/constants';\n\n// ============================================================\n// TYPES\n// ============================================================\n\nexport interface VideoPlayerProps {\n  videoId: string;\n  startTime?: number;\n  onTimeUpdate?: (currentTime: number) => void;\n  onEnded?: () => void;\n  className?: string;\n}\n\nexport interface VideoControlState {\n  isPlaying: boolean;\n  currentTime: number;\n  duration: number;\n  volume: number;\n  playbackRate: 0.5 | 0.75 | 1.0 | 1.25 | 1.5 | 2.0;\n  isMuted: boolean;\n  isFullscreen: boolean;\n  showControls: boolean;\n}\n\n// ============================================================\n// CONSTANTS\n// ============================================================\n\nconst SKIP_AMOUNTS = {\n  backwardLarge: -10,\n  backwardSmall: -5,\n  forwardSmall: 5,\n  forwardLarge: 10,\n} as const;\n\nconst PLAYBACK_RATES = [0.5, 0.75, 1.0, 1.25, 1.5, 2.0] as const;\n\nconst CONTROLS_IDLE_TIMEOUT = 3000; // ms\n\n// ============================================================\n// COMPONENT\n// ============================================================\n\n/**\n * VideoPlayer - Player de YouTube con controles premium\n *\n * Caracter√≠sticas:\n * - Seek bar con gradiente y preview\n * - Botones de skip (-10s, -5s, +5s, +10s)\n * - Control de velocidad (0.5x - 2x)\n * - Control de volumen con slider animado\n * - Fullscreen y picture-in-picture\n * - Keyboard shortcuts (espacio, flechas, M, F)\n * - Progreso guardado autom√°ticamente\n * - Controles que desaparecen en idle\n */\nexport function VideoPlayer({\n  videoId,\n  startTime = 0,\n  onTimeUpdate,\n  onEnded,\n  className = '',\n}: VideoPlayerProps) {\n  // Refs\n  const playerRef = useRef<any>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const controlsIdleTimerRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Estado\n  const [state, setState] = useState<VideoControlState>({\n    isPlaying: false,\n    currentTime: startTime,\n    duration: 0,\n    volume: 1,\n    playbackRate: 1.0 as const,\n    isMuted: false,\n    isFullscreen: false,\n    showControls: true,\n  });\n\n  const [isAPIReady, setIsAPIReady] = useState(false);\n  const [isPlayerReady, setIsPlayerReady] = useState(false);\n\n  // Cargar YouTube API\n  useEffect(() => {\n    if (typeof window !== 'undefined' && !window.YT) {\n      const tag = document.createElement('script');\n      tag.src = 'https://www.youtube.com/iframe_api';\n      const firstScriptTag = document.getElementsByTagName('script')[0];\n      firstScriptTag.parentNode?.insertBefore(tag, firstScriptTag);\n\n      window.onYouTubeIframeAPIReady = () => {\n        setIsAPIReady(true);\n      };\n    } else if (window.YT) {\n      setIsAPIReady(true);\n    }\n  }, []);\n\n  // Inicializar player cuando API est√© lista\n  useEffect(() => {\n    if (!isAPIReady || !containerRef.current || playerRef.current || !window.YT) return;\n\n    const YT = window.YT;\n    playerRef.current = new YT.Player(containerRef.current, {\n      videoId,\n      playerVars: {\n        autoplay: 0,\n        controls: 0,\n        modestbranding: 1,\n        rel: 0,\n      },\n      events: {\n        onReady: (event: any) => {\n          const duration = event.target.getDuration();\n          setIsPlayerReady(true);\n          setState(prev => ({ ...prev, duration }));\n\n          // Set initial time if provided\n          if (startTime > 0) {\n            event.target.seekTo(startTime, true);\n          }\n        },\n        onStateChange: (event: any) => {\n          const playerState = event.target.getPlayerState();\n          const isPlaying = playerState === YT.PlayerState.PLAYING;\n          const isEnded = playerState === YT.PlayerState.ENDED;\n\n          setState(prev => ({ ...prev, isPlaying }));\n\n          if (isEnded) {\n            onEnded?.();\n          }\n        },\n      },\n    });\n\n    return () => {\n      if (playerRef.current?.destroy) {\n        playerRef.current.destroy();\n      }\n    };\n  }, [isAPIReady, videoId, startTime, onEnded]);\n\n  // Actualizar tiempo actual\n  useEffect(() => {\n    if (!isPlayerReady || !state.isPlaying) return;\n\n    const interval = setInterval(() => {\n      if (playerRef.current?.getCurrentTime) {\n        const currentTime = playerRef.current.getCurrentTime();\n        setState(prev => ({ ...prev, currentTime }));\n        onTimeUpdate?.(currentTime);\n      }\n    }, 250);\n\n    return () => clearInterval(interval);\n  }, [isPlayerReady, state.isPlaying, onTimeUpdate]);\n\n  // Reset timer de controles idle\n  const resetControlsIdleTimer = useCallback(() => {\n    if (controlsIdleTimerRef.current) {\n      clearTimeout(controlsIdleTimerRef.current);\n    }\n\n    setState(prev => ({ ...prev, showControls: true }));\n\n    if (state.isPlaying) {\n      controlsIdleTimerRef.current = setTimeout(() => {\n        setState(prev => ({ ...prev, showControls: false }));\n      }, CONTROLS_IDLE_TIMEOUT);\n    }\n  }, [state.isPlaying]);\n\n  // Manejar movimiento del mouse para mostrar controles\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleMouseMove = () => resetControlsIdleTimer();\n\n    container.addEventListener('mousemove', handleMouseMove);\n    container.addEventListener('click', handleMouseMove);\n\n    return () => {\n      container.removeEventListener('mousemove', handleMouseMove);\n      container.removeEventListener('click', handleMouseMove);\n    };\n  }, [resetControlsIdleTimer]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (!isPlayerReady) return;\n\n      switch (e.key) {\n        case ' ':\n        case 'k':\n          e.preventDefault();\n          togglePlay();\n          break;\n        case 'ArrowLeft':\n          e.preventDefault();\n          skip(SKIP_AMOUNTS.backwardSmall);\n          break;\n        case 'ArrowRight':\n          e.preventDefault();\n          skip(SKIP_AMOUNTS.forwardSmall);\n          break;\n        case 'j':\n          skip(SKIP_AMOUNTS.backwardLarge);\n          break;\n        case 'l':\n          skip(SKIP_AMOUNTS.forwardLarge);\n          break;\n        case 'm':\n          toggleMute();\n          break;\n        case 'f':\n          toggleFullscreen();\n          break;\n        case '<':\n        case ',':\n          changePlaybackRate(-0.25);\n          break;\n        case '>':\n        case '.':\n          changePlaybackRate(0.25);\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [isPlayerReady]);\n\n  // Controles\n  const togglePlay = useCallback(() => {\n    if (!playerRef.current) return;\n\n    if (state.isPlaying) {\n      playerRef.current.pauseVideo();\n    } else {\n      playerRef.current.playVideo();\n    }\n  }, [state.isPlaying]);\n\n  const skip = useCallback((amount: number) => {\n    if (!playerRef.current) return;\n\n    const currentTime = playerRef.current.getCurrentTime();\n    const newTime = Math.max(0, Math.min(currentTime + amount, state.duration));\n    playerRef.current.seekTo(newTime, true);\n    setState(prev => ({ ...prev, currentTime: newTime }));\n  }, [state.duration]);\n\n  const handleSeek = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!playerRef.current) return;\n\n    const newTime = parseFloat(e.target.value);\n    playerRef.current.seekTo(newTime, true);\n    setState(prev => ({ ...prev, currentTime: newTime }));\n  }, []);\n\n  const changeVolume = useCallback((newVolume: number) => {\n    if (!playerRef.current) return;\n\n    playerRef.current.setVolume(newVolume * 100);\n    setState(prev => ({ ...prev, volume: newVolume, isMuted: newVolume === 0 }));\n  }, []);\n\n  const toggleMute = useCallback(() => {\n    if (!playerRef.current) return;\n\n    if (state.isMuted) {\n      playerRef.current.unMute();\n      playerRef.current.setVolume(state.volume * 100);\n      setState(prev => ({ ...prev, isMuted: false }));\n    } else {\n      playerRef.current.mute();\n      setState(prev => ({ ...prev, isMuted: true }));\n    }\n  }, [state.isMuted, state.volume]);\n\n  const setPlaybackRate = useCallback((rate: 0.5 | 0.75 | 1.0 | 1.25 | 1.5 | 2.0) => {\n    if (!playerRef.current) return;\n\n    playerRef.current.setPlaybackRate(rate);\n    setState(prev => ({ ...prev, playbackRate: rate }));\n  }, []);\n\n  const changePlaybackRate = useCallback((delta: number) => {\n    const currentIndex = PLAYBACK_RATES.indexOf(state.playbackRate);\n    const newIndex = Math.max(0, Math.min(PLAYBACK_RATES.length - 1, currentIndex + (delta > 0 ? 1 : -1)));\n    setPlaybackRate(PLAYBACK_RATES[newIndex]);\n  }, [state.playbackRate, setPlaybackRate]);\n\n  const toggleFullscreen = useCallback(() => {\n    if (!document.fullscreenElement) {\n      containerRef.current?.requestFullscreen();\n      setState(prev => ({ ...prev, isFullscreen: true }));\n    } else {\n      document.exitFullscreen();\n      setState(prev => ({ ...prev, isFullscreen: false }));\n    }\n  }, []);\n\n  // Formatear tiempo\n  const formatTime = (seconds: number): string => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const progress = state.duration > 0 ? (state.currentTime / state.duration) * 100 : 0;\n\n  return (\n    <div\n      ref={containerRef}\n      className={`relative w-full bg-black rounded-xl overflow-hidden group ${className}`}\n      onMouseMove={resetControlsIdleTimer}\n    >\n      {/* YouTube Iframe Container */}\n      <div id={`youtube-player-${videoId}`} className=\"w-full aspect-video\" />\n\n      {/* Overlay de carga */}\n      {!isPlayerReady && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-black/80\">\n          <motion.div\n            className=\"w-12 h-12 border-4 border-sky-500 border-t-transparent rounded-full\"\n            animate={{ rotate: 360 }}\n            transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n          />\n        </div>\n      )}\n\n      {/* Bot√≥n de play central (cuando est√° pausado) */}\n      <AnimatePresence>\n        {!state.isPlaying && isPlayerReady && (\n          <motion.button\n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            exit={{ opacity: 0, scale: 0.8 }}\n            onClick={togglePlay}\n            className=\"absolute inset-0 flex items-center justify-center bg-black/30 hover:bg-black/40 transition-colors\"\n            aria-label=\"Reproducir video\"\n          >\n            <motion.div\n              className=\"w-20 h-20 rounded-full INPUT_COLORS.video.bgDark/90 flex items-center justify-center\"\n              whileHover={{ scale: 1.1 }}\n              whileTap={{ scale: 0.95 }}\n            >\n              <span className=\"text-white text-4xl ml-1\">‚ñ∂</span>\n            </motion.div>\n          </motion.button>\n        )}\n      </AnimatePresence>\n\n      {/* Controles flotantes */}\n      <AnimatePresence>\n        {state.showControls && (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 20 }}\n            transition={{ duration: 0.2 }}\n            className=\"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/90 to-transparent\"\n          >\n            {/* Seek bar */}\n            <div className=\"mb-4\">\n              <input\n                type=\"range\"\n                min={0}\n                max={state.duration}\n                step={0.1}\n                value={state.currentTime}\n                onChange={handleSeek}\n                className=\"w-full h-2 bg-white/20 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:INPUT_COLORS.video.bgDark [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:hover:scale-125 [&::-webkit-slider-thumb]:transition-transform\"\n                style={{\n                  background: `linear-gradient(to right, #0EA5E9 ${progress}%, rgba(255,255,255,0.2) ${progress}%)`,\n                }}\n              />\n              <div className=\"flex justify-between mt-1 text-xs text-white/70\">\n                <span>{formatTime(state.currentTime)}</span>\n                <span>{formatTime(state.duration)}</span>\n              </div>\n            </div>\n\n            {/* Botones de control */}\n            <div className=\"flex items-center justify-between\">\n              {/* Izquierda: Play/Pause, Skip, Volume */}\n              <div className=\"flex items-center gap-2\">\n                {/* Play/Pause */}\n                <button\n                  onClick={togglePlay}\n                  className=\"p-2 text-white hover:INPUT_COLORS.video.textColor transition-colors\"\n                  aria-label={state.isPlaying ? 'Pausar' : 'Reproducir'}\n                >\n                  {state.isPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'}\n                </button>\n\n                {/* Skip backward */}\n                <button\n                  onClick={() => skip(SKIP_AMOUNTS.backwardLarge)}\n                  className=\"px-2 py-1 text-sm text-white/70 hover:text-white transition-colors\"\n                  aria-label=\"-10 segundos\"\n                >\n                  -10s\n                </button>\n                <button\n                  onClick={() => skip(SKIP_AMOUNTS.backwardSmall)}\n                  className=\"px-2 py-1 text-sm text-white/70 hover:text-white transition-colors\"\n                  aria-label=\"-5 segundos\"\n                >\n                  -5s\n                </button>\n\n                {/* Skip forward */}\n                <button\n                  onClick={() => skip(SKIP_AMOUNTS.forwardSmall)}\n                  className=\"px-2 py-1 text-sm text-white/70 hover:text-white transition-colors\"\n                  aria-label=\"+5 segundos\"\n                >\n                  +5s\n                </button>\n                <button\n                  onClick={() => skip(SKIP_AMOUNTS.forwardLarge)}\n                  className=\"px-2 py-1 text-sm text-white/70 hover:text-white transition-colors\"\n                  aria-label=\"+10 segundos\"\n                >\n                  +10s\n                </button>\n\n                {/* Volume */}\n                <div className=\"flex items-center gap-2 ml-4\">\n                  <button\n                    onClick={toggleMute}\n                    className=\"text-white/70 hover:text-white transition-colors\"\n                    aria-label={state.isMuted ? 'Activar sonido' : 'Silenciar'}\n                  >\n                    {state.isMuted || state.volume === 0 ? 'üîá' : state.volume < 0.5 ? 'üîâ' : 'üîä'}\n                  </button>\n                  <input\n                    type=\"range\"\n                    min={0}\n                    max={1}\n                    step={0.1}\n                    value={state.isMuted ? 0 : state.volume}\n                    onChange={(e) => changeVolume(parseFloat(e.target.value))}\n                    className=\"w-20 h-1 bg-white/20 rounded-full appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:rounded-full\"\n                  />\n                </div>\n              </div>\n\n              {/* Derecha: Speed, Fullscreen */}\n              <div className=\"flex items-center gap-2\">\n                {/* Playback rate */}\n                <div className=\"flex items-center bg-white/10 rounded-lg\">\n                  {PLAYBACK_RATES.map((rate) => (\n                    <button\n                      key={rate}\n                      onClick={() => setPlaybackRate(rate)}\n                      className={`\n                        px-2 py-1 text-sm font-medium transition-colors\n                        ${state.playbackRate === rate\n                          ? 'INPUT_COLORS.video.bgDark text-white'\n                          : 'text-white/70 hover:text-white hover:bg-white/10'\n                        }\n                      `}\n                      aria-label={`Velocidad ${rate}x`}\n                    >\n                      {rate}x\n                    </button>\n                  ))}\n                </div>\n\n                {/* Fullscreen */}\n                <button\n                  onClick={toggleFullscreen}\n                  className=\"p-2 text-white/70 hover:text-white transition-colors\"\n                  aria-label=\"Pantalla completa\"\n                >\n                  {state.isFullscreen ? '‚õ∂' : '‚õ∂'}\n                </button>\n              </div>\n            </div>\n\n            {/* Keyboard shortcuts hint */}\n            <div className=\"mt-3 pt-2 border-t border-white/10\">\n              <p className=\"text-xs text-white/50 text-center\">\n                Atajos: Espacio/K=Play ‚Üê‚Üí=Skip M=Mute F=Fullscreen ,.=Velocidad\n              </p>\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </div>\n  );\n}\n\nexport default VideoPlayer;\n","usedDeprecatedRules":[]}]
